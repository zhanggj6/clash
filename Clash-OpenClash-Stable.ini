port: 7890
socks-port: 7891
mixed-port: 7893
allow-lan: true
mode: rule
log-level: info
ipv6: false
bind-address: "*"

external-controller: 0.0.0.0:9090
secret: ""

# ======================
# DNSï¼ˆmacvlan / HA å¿…é¡»è¿™æ ·ï¼‰
# ======================
dns:
  enable: true
  listen: 0.0.0.0:7874
  ipv6: false
  enhanced-mode: redir-host      # â—ç¦æ­¢ fake-ip
  respect-rules: true

  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query

  fallback:
    - https://dns.cloudflare.com/dns-query
    - tls://8.8.4.4:853

  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4

# ======================
# ä»£ç†èŠ‚ç‚¹ï¼ˆç”±è®¢é˜…è‡ªåŠ¨ç”Ÿæˆï¼‰
# ======================
proxies: []

proxy-groups:
  - name: ğŸš€ é»˜è®¤ä»£ç†
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸŒ å›½å¤–èŠ‚ç‚¹
      - DIRECT

  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 100
    use:
      - provider-airport

  - name: ğŸŒ å›½å¤–èŠ‚ç‚¹
    type: select
    use:
      - provider-airport

# ======================
# è®¢é˜…æä¾›å™¨ï¼ˆæœºåœºï¼‰
# ======================
proxy-providers:
  provider-airport:
    type: http
    url: "ä½ çš„æœºåœºè®¢é˜…åœ°å€"
    interval: 3600
    path: ./providers/airport.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

# ======================
# è§„åˆ™é›†
# ======================
rule-providers:
  private:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.list
    path: ./ruleset/private.yaml
    interval: 86400

  cn:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.list
    path: ./ruleset/cn.yaml
    interval: 86400

  global:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Global/Global.list
    path: ./ruleset/global.yaml
    interval: 86400

# ======================
# è§„åˆ™ï¼ˆé¡ºåºéå¸¸é‡è¦ï¼‰
# ======================
rules:
  # æœ¬æœº & Docker & macvlan
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,192.168.8.0/24,DIRECT

  # å±€åŸŸç½‘åŸŸå
  - RULE-SET,private,DIRECT

  # ä¸­å›½ç›´è¿
  - RULE-SET,cn,DIRECT
  - GEOIP,CN,DIRECT

  # å›½å¤–
  - RULE-SET,global,ğŸš€ é»˜è®¤ä»£ç†

  # å…œåº•
  - MATCH,ğŸš€ é»˜è®¤ä»£ç†
