port: 7890
socks-port: 7891
mixed-port: 7893
allow-lan: true
mode: rule
log-level: info
ipv6: false
bind-address: "*"

external-controller: 0.0.0.0:9090

####################
# DNSï¼ˆå…³é”®ä¿®æ”¹ï¼‰
####################
dns:
  enable: true
  listen: 0.0.0.0:7874
  ipv6: false
  enhanced-mode: redir-host
  respect-rules: true

  # åªç”¨äºè§£æå›½å†…
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29

  # ä¸» DNSï¼ˆå…¨éƒ¨èµ°ä»£ç†ï¼‰
  nameserver:
    - https://dns.cloudflare.com/dns-query
    - tls://8.8.8.8:853

  # â—ä¸å†ä½¿ç”¨ fallback-filter.geoip
  fallback: []

####################
# æœºåœºè®¢é˜…
####################
proxy-providers:
  airport:
    type: http
    url: "ä½ çš„æœºåœºè®¢é˜…"
    interval: 3600
    path: ./providers/airport.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300

####################
# ç­–ç•¥ç»„
####################
proxy-groups:
  - name: ğŸš€ é»˜è®¤ä»£ç†
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨
      - ğŸŒ å…¨éƒ¨èŠ‚ç‚¹
      - DIRECT

  - name: â™»ï¸ è‡ªåŠ¨
    type: url-test
    use:
      - airport
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 100

  - name: ğŸŒ å…¨éƒ¨èŠ‚ç‚¹
    type: select
    use:
      - airport

####################
# è§„åˆ™é›†
####################
rule-providers:
  openai:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/OpenAI/OpenAI.list
    path: ./ruleset/openai.yaml
    interval: 86400

  lan:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.list
    path: ./ruleset/lan.yaml
    interval: 86400

  cn:
    type: http
    behavior: domain
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.list
    path: ./ruleset/cn.yaml
    interval: 86400

####################
# è§„åˆ™ï¼ˆé‡æ–°æ’åºï¼‰
####################
rules:
  # æœ¬æœº / Docker / macvlan
  - IP-CIDR,127.0.0.0/8,DIRECT
  - IP-CIDR,10.0.0.0/8,DIRECT
  - IP-CIDR,172.16.0.0/12,DIRECT
  - IP-CIDR,192.168.8.0/24,DIRECT

  # HA / IoT
  - RULE-SET,lan,DIRECT

  # â—ChatGPT å¼ºåˆ¶ä»£ç†
  - RULE-SET,openai,ğŸš€ é»˜è®¤ä»£ç†

  # ä¸­å›½ç›´è¿ï¼ˆæ”¾åé¢ï¼‰
  - RULE-SET,cn,DIRECT
  - GEOIP,CN,DIRECT

  # å…œåº•å…¨éƒ¨ä»£ç†
  - MATCH,ğŸš€ é»˜è®¤ä»£ç†
